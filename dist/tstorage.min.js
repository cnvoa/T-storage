/**
 * Tstorage v1.0.0
 * (c) 2020-3-11 mentals@foxmail.com
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Tstorage=t()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var t=!!window.localStorage,i={verson:"1.0.0",storage:t?window.localStorage:null,session:{storage:t?window.sessionStorage:null,type:"session"}},n={data:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.disabled){e=e||"store";var i=(new Date).getTime(),n=null;if(null===t)return delete this.storage[e];try{n=JSON.parse(this.storage[e])}catch(e){n={}}if(u(n,i),"value"in t&&"key"in t){var a=null;if("time"in t){var r=function(e){if(""==e)return"";if(!/[/\-:]/g.test(e))return{type:"second",value:e};var t=e.match(/:/g),i=e.split(" ",2);if(1==i.length)return{type:"stamps",value:l(e)};{if(!t||0==t.length)return parseInt(i[1])?{type:"stamps",value:l(e+":00")}:{type:"stamps",value:l(i[0])};if(2<t.length)return{type:"nan",value:NaN}}return":"!=e.charAt(e.length-1)?{type:"stamps",value:l(e)}:{type:"stamps",value:l(e+"00")}}(t.time),s=r.type,o=r.value;if("second"==s&&(a=(new Date).getTime()+1e3*o),"stamps"==s&&(a=o),"nan"==s)return console.log("Store failed"),!1}"session"!=this.type&&a&&(t.value.limitTime=a+""),n[t.key]=t.value}return"remove"in t&&delete n[t.key],this.storage.setItem(e,JSON.stringify(n)),t.key?n[t.key]:n}},has:function(e,t){if(!this.disabled&&""!==e&&null!=e){var i=(new Date).getTime(),n=null;try{n=JSON.parse(this.storage[e])}catch(e){n={}}if(void 0!==this.storage[e])return u(n,i),this.storage[e]=JSON.stringify(n),t?n[t]||void 0:n||void 0}},clear:function(){this.disabled||this.storage.clear()},getAll:function(){if(!this.disabled){var i={};return this.forEach(function(e,t){i[e]=t}),i}},forEach:function(e){if(!this.disabled)for(var t=0;t<this.storage.length;t++){var i=this.storage.key(t);e(i,this.data(i))}}};function l(e){return new Date(e).getTime()}function u(e,t){for(var i in e)t>e[i].limitTime&&delete e[i]}e(i,n),e(i.session,n);try{var a="store",r={};i.data(a,r),JSON.stringify(i.data(a))!==JSON.stringify(r)&&(i.disabled=!0),i.data(a,null)}catch(e){i.disabled=!0}return i});