/**
 * Tstorage v1.0.0
 * (c) 2020-3-13 mentals@foxmail.com
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Tstorage=t()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e}).apply(this,arguments)}var t=!!window.localStorage,i={verson:"1.0.0",storage:t?window.localStorage:null,session:{storage:t?window.sessionStorage:null,type:"session"}},a={data:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!this.disabled){e=e||"store";var i=(new Date).getTime(),a=null;if(null===t)return delete this.storage[e];try{a=JSON.parse(this.storage[e])}catch(e){a={}}if(u(a,i),"value"in t&&"key"in t){var n=null;if("time"in t){var r=function(e){if(""==e)return"";if(!/[/\-:]/g.test(e))return{type:"second",value:e};var t=e.match(/:/g),i=e.split(" ",2);if(1==i.length)return{type:"stamps",value:l(e)};{if(!t||0==t.length)return parseInt(i[1])?{type:"stamps",value:l(e+":00")}:{type:"stamps",value:l(i[0])};if(2<t.length)return{type:"nan",value:NaN}}return":"!=e.charAt(e.length-1)?{type:"stamps",value:l(e)}:{type:"stamps",value:l(e+"00")}}(t.time),s=r.type,o=r.value;switch(s){case"second":n=(new Date).getTime()+1e3*o;break;case"stamps":n=o;break;default:try{console.warn("Store failed!")}catch(e){console.log("Store failed!")}return}if(n<=i){try{console.warn("Storage time can only be future time!")}catch(e){console.log("Storage time can only be future time!")}return}}"session"!=this.type&&n&&(t.value.limitTime=n+""),a[t.key]=t.value}return"remove"in t&&delete a[t.key],this.storage.setItem(e,JSON.stringify(a)),t.key?a[t.key]:a}},has:function(e,t){if(!this.disabled&&""!==e&&null!=e){var i=(new Date).getTime(),a=null;try{a=JSON.parse(this.storage[e])}catch(e){a={}}if(void 0!==this.storage[e])return u(a,i),this.storage[e]=JSON.stringify(a),t?a[t]||void 0:a||void 0}},clear:function(){this.disabled||this.storage.clear()},getAll:function(){if(!this.disabled){var i={};return this.forEach(function(e,t){i[e]=t}),i}},forEach:function(e){if(!this.disabled)for(var t=0;t<this.storage.length;t++){var i=this.storage.key(t);e(i,this.data(i))}}};function l(e){return new Date(e).getTime()}function u(e,t){for(var i in e)t>e[i].limitTime&&delete e[i]}e(i,a),e(i.session,a);try{var n="store",r={};i.data(n,r),JSON.stringify(i.data(n))!==JSON.stringify(r)&&(i.disabled=!0),i.data(n,null)}catch(e){i.disabled=!0}return i});